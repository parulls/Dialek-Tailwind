<!-- <?php
    require '.functions.php';
?> -->

<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dialek.id</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../styles/style2.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

</head>
<body class="bg-custom-radial font-inter flex flex-col min-h-screen">

    <!-- Navbar -->
    <nav class="flex items-center justify-between w-full px-12 py-12">
        <div class="logo font-irish m-0 text-2xl">dialek.id</div>
        <div class="flex items-center m-0 font-semibold text-custom2">
            <p id="account-username" class="px-4 text-xl">username</p>
            <i class="fa-solid fa-user text-2xl"></i> 
        </div>
    </nav>

  


    <main class="flex flex-col items-center flex-grow">
    <!-- Judul -->
    <h1 class="text-4xl font-bold text-gradient text-center py-6 ">Sambung Kata</h1>

    
     
            <!-- Kosakata yang Digunakan -->
            <div class="col-span-2 p-4 rounded-lg shadow-lg w-7/12 " style="background-color: rgba(243, 245, 243, 0.4)">
                <div id="used-vocabulary" class="mt-4 overflow-y-auto h-72"></div>         
            </div>
             <!--button mulai-->
             <div class="flex justify-end mt-4 w-7/12">
                <button id="startbutton" class="bg-green-800 text-white py-2 px-6 rounded-full shadow-md hover:bg-green-700">
                   Mulai</button>
                   <button class="h-6/12 ml-2" id="infoButton">
                   <i class="fa-solid fa-circle-info"></i> 
                    </button>        
            </div>

          
            <div class="grid grid-cols-2 gap-8 w-7/12 py-6">
            <!-- Peringkat Harian -->
            <div class="rounded-lg shadow-lg p-4" style="background-color: rgba(243, 245, 243, 0.4)">
                <h2 class="text-2xl font-extrabold text-center" 
                style="background-image: linear-gradient(180deg, #14856D 0%, #067A32 50%, #16572B 87%, #1B4B29 100%);
                 -webkit-background-clip: text;
                color: transparent;">
                Peringkat Harian
                </h2>
                <ul id="daily-rankings" class="mt-4">
                    <li>
                        <div class="flex items-center space-x-2">
                            <p class="font-semibold text-green-900 text-md " >1.</p>
                            <img src="https://img.icons8.com/color/48/000000/user.png" alt="user" class="w-8 h-8 rounded-full mr-4 ml-4" />
                            <p class="font-semibold text-green-900 flex-grow text-md md:text-base flex-1">username</p>
                        </div></li>
                    <li><div class="flex items-center space-x-2 space-y-2">
                        <p class="font-semibold text-green-900 text-md " >2.</p>
                        <img src="https://img.icons8.com/color/48/000000/user.png" alt="user" class="w-8 h-8 rounded-full mr-4 ml-4" />
                        <p class="font-semibold text-green-900 flex-grow text-md md:text-base flex-1">username</p>
                    </div></li>
                    <li><div class="flex items-center space-x-2 space-y-2">
                        <p class="font-semibold text-green-900 text-md " >3.</p>
                        <img src="https://img.icons8.com/color/48/000000/user.png" alt="user" class="w-8 h-8 rounded-full mr-4 ml-4" />
                        <p class="font-semibold text-green-900 flex-grow text-md md:text-base flex-1">username</p>
                    </div></li>
                </ul>
            </div>

            <!-- Skor -->
            <div class="rounded-lg shadow-lg p-4" style="background-color: rgba(243, 245, 243, 0.4)">
                <div class="flex">
                <h2 class="text-2xl font-extrabold" style="background-image: linear-gradient(180deg, #14856D 0%, #067A32 50%, #16572B 87%, #1B4B29 100%);
                -webkit-background-clip: text;
               color: transparent;">Skor :</h2>
                <div class=" px-2 text-2xl font-extrabold" style="background-image: linear-gradient(180deg, #14856D 0%, #067A32 50%, #16572B 87%, #1B4B29 100%);
                -webkit-background-clip: text;
               color: transparent;" id="total-score">0</div>
            </div>
            <div class="py-3">
                <canvas id="accuracyChart" width="200" height="200"></canvas>
            </div>
            
            </div>

            <!-- Statistik Permainan -->
            <div class="rounded-lg shadow-lg p-4 col-span-2" style="background-color: rgba(243, 245, 243, 0.4)">

                <div class="flex justify-between mt-4">
                    <div class="rounded-lg p-4 mr-2" style="background-color: #daead1;">
                        <p class="text-xl font-bold text-green-900">Kata Berhasil:</p>
                        <p id="successful-words" class="text-2xl font-bold text-center text-green-900">0</p>
                    </div>
                    <div class="rounded-lg p-4" style="background-color: #daead1;">
                        <p class="text-xl font-bold text-green-900">Kata Gagal:</p>
                        <p id="failed-words" class="text-2xl font-bold text-center text-green-900">0</p>
                    </div>
                    <div class="rounded-lg p-4 ml-2" style="background-color: #daead1;">
                        <p class="text-xl font-bold text-green-900">Akurasi:</p>
                        <p id="accuracy" class="text-2xl font-bold text-center text-green-900">0%</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="info-popup" class="fixed inset-0 flex items-center justify-center bg-gray-900 bg-opacity-50" style="display: none;">
            <div class="p-6 rounded-lg shadow-lg text-center" style="background-color: #CBEADF;">
                <p id="popup-message" class="text-lg font-bold mb-4">
                    Instruksi:
                    <ul>
                        <li>1. Ketik kata Batak Toba yang valid di kotak input dan tekan Enter. Kata harus dimulai dengan huruf terakhir dari kata sebelumnya dan belum pernah digunakan.</li>
                        <li>2. Kata baru yang valid +10, kata yang pernah digunakan +5</li>
                        <li>3.  Setelah giliran Anda, AI akan mencari kata yang valid. Skor AI bertambah sesuai aturan yang sama.</li>
                        <li>4.Anda menang jika AI tidak bisa menemukan kata yang valid, atau skor akhir Anda lebih tinggi saat waktu habis.</li>
                    </ul>
                </p>
                <button onclick="closePopup()" class="bg-green-900 hover:bg-green-800 text-white font-bold py-2 px-4 rounded">OK</button>
            </div>
        </div>

    </main>

    <script>
        // Ambil data permainan dari local storage
        const successfulWordsCount = parseInt(localStorage.getItem('successfulWordsCount') || '0', 10);
        const failedWordsCount = parseInt(localStorage.getItem('failedWordsCount') || '0', 10);
        const totalScore = parseInt(localStorage.getItem('totalScore') || '0', 10);
        const usedVocabulary = JSON.parse(localStorage.getItem('usedVocabulary') || '[]');

        // Hitung akurasi
        const totalAttempts = successfulWordsCount + failedWordsCount;
        const accuracy = totalAttempts > 0 ? Math.round((successfulWordsCount / totalAttempts) * 100) : 0;


        const ctx = document.getElementById('accuracyChart').getContext('2d');
        new Chart(ctx, {
        type: 'pie',
        data: {
            labels: ['Kata Berhasil', 'Kata Gagal'],
            datasets: [{
                data: [successfulWordsCount, failedWordsCount],
                backgroundColor: ['#ADDFB3', '#62AA6D'],
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    display: true,
                    position: 'bottom'
                }
            }
        }
    });

        // Tampilkan data permainan di halaman
        document.getElementById("total-score").textContent = totalScore;
        document.getElementById("successful-words").textContent = successfulWordsCount;
        document.getElementById("failed-words").textContent = failedWordsCount;
        document.getElementById("accuracy").textContent = accuracy + "%";

        // Tampilkan kosakata yang digunakan
        const usedVocabularyContainer = document.getElementById("used-vocabulary");
        usedVocabulary.forEach(word => {
            const wordElement = document.createElement("p");
            wordElement.textContent = word;
            wordElement.className = "text-lg text-green-900";
            usedVocabularyContainer.appendChild(wordElement);
        });

        const play = document.getElementById("startbutton");
        const Back = document.querySelector("backbutton");
        const infoButton = document.getElementById("infoButton");

        startbutton.addEventListener("click", () => {
            window.location.href = "Permainan2.html";
        });

       

        infoButton.addEventListener("click", () => {
            document.getElementById("info-popup").style.display = "flex";
        });

        closePopup = () => {
            document.getElementById("info-popup").style.display = "none";
        };

        // Hapus data dari local storage setelah ditampilkan
        localStorage.removeItem('successfulWordsCount');
        localStorage.removeItem('failedWordsCount');
        localStorage.removeItem('totalScore');
        localStorage.removeItem('usedVocabulary');
    </script>

</body>
</html>
